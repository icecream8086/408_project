# B+树与B树的比较与应用

## 摘要
本笔记系统对比B+树与B树的核心差异，解析B+树在数据库中的存储优化机制。通过结构化对比、磁盘I/O模型分析，阐明B+树更适合大规模数据存储的技术原理。

## 主题
平衡树结构在存储系统中的关键实现：
- **核心方法**：关键字分布优化/磁盘块映射/分层索引设计
- **对比维度**：分支数规则/存储效率/查找路径
- **应用焦点**：数据库索引设计（B+树）vs 内存数据结构（B树）

> 重点难点
> - B+树N关键字→N分支的数学约束
> - 非叶节点仅作索引的工程意义
> - 多级磁盘块加载的I/O成本模型

---

## 线索区

### 知识点1: B+树结构特性
**定义**  
平衡多路搜索树，满足：
- **分支约束**：$n$关键字对应$n$子树（B树为$n+1$）
- **层级平衡**：$\forall$叶子节点距根高度相同
- **全量存储**：叶子节点包含**所有关键字副本**

**存储优化**  
$$\text{节点大小} = \text{磁盘块大小}$$  
通过对齐磁盘物理块（通常4KB），实现单次I/O读取完整节点数据

---

### 知识点2: B+树 vs B树  
| 特征        | B+树                     | B树                  |
|------------|--------------------------|---------------------|
| 关键字存储   | 非叶节点仅索引，叶节点全量存储 | 所有节点存储数据     |
| 分支规则     | N关键字→N分支             | N关键字→N+1分支      |
| 查找终止点   | 必须到达叶节点            | 可在内部节点终止     |
| 范围查询     | 叶节点链表支持高效扫描      | 需要回溯遍历         |

**典型应用场景**  
- B+树：MySQL索引/文件系统  
- B树：内存数据库/缓存系统  

---

### 知识点3: 磁盘I/O优化机制  
**查找过程分解**  
1. 加载根节点磁盘块 → 内存  
2. 二分查找确定子树指针  
3. 递归加载子节点块  
4. 到达叶节点获取数据  

**优化关键**  
- **扇出最大化**：单节点容纳更多关键字（减少树高度）  
- **顺序访问**：叶节点链表实现$O(1)$范围查询  
- **预读优化**：利用磁盘顺序读取特性批量加载相邻节点  

---

## 总结区

**核心结论**  
1. B+树通过**关键字-分支数严格对应**实现更高存储密度  
2. **非叶节点纯索引**特性减少非必要磁盘访问  
3. **全量叶节点存储**支持高效范围查询  

**典型考点**  
- 计算B+树最大/最小高度（给定关键字总数和节点容量）  
- 分析特定查询场景的磁盘I/O次数  
- 比较B+树与哈希索引的适用场景  

**技术延伸**  
- B+树节点分裂策略（50-50 vs 非对称分裂）  
- 现代数据库的B+树变种（B*树、LSM树）  
- SSD特性对B+树设计的影响（随机读性能提升）  

公式标注示例：  
设节点容量为$m$，树高度为$h$，则关键字总数$N$满足：  
$$N \geq 2\lceil m/2 \rceil^{h-1}$$