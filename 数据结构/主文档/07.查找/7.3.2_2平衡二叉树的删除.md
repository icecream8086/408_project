# 平衡二叉树的删除操作

## 摘要
本笔记系统解析平衡二叉树（AVL树）删除操作的核心流程，通过节点替换策略与旋转调整机制维护平衡特性。重点阐述**最小不平衡子树定位**与**旋转类型选择**的决策逻辑，揭示删除操作与插入操作调整方法的一致性原理。

---

## 主题
**平衡维护三阶段**：节点删除 → 平衡因子更新 → 旋转调整  
**关键决策点**：前驱/后继选择策略、孙子节点位置判定、旋转类型映射  
**核心公式**：  
平衡因子 BF = h_left - h_right  
旋转触发条件 |BF| ≥ 2  

> 重点难点
> 
> - 多级不平衡传导的迭代处理
> - LR/RL型双旋转的分解执行顺序
> - 子树高度变化对祖先链的影响传播

---

## 线索区

### 知识点1：节点删除策略
**定义**  
当删除节点具有双子树时，采用前驱（左子树最大值）或后继（右子树最小值）进行值替换，转化为单子树/叶子节点删除问题  

**执行流程**  
1. 定位目标节点（例：节点75）  
2. 搜索前驱节点（例：节点60）  
3. 值替换：`75→60`  
4. 删除原前驱节点（转化为单子树删除）  

**数学表达**  
前驱节点定位公式：  
$$ \text{pred}(x) = \arg\max_{y \in \text{left\_subtree}(x)} y.\text{key} $$

---

### 知识点2：旋转类型判定矩阵
**孙子位置 → 旋转类型映射**  
| 孙子节点位置 | 旋转类型 | 分解步骤          |
|--------------|----------|-------------------|
| 左子树左子树 | LL       | 单右旋            |
| 右子树右子树 | RR       | 单左旋            |
| 左子树右子树 | LR       | 先左旋后右旋      |
| 右子树左子树 | RL       | 先右旋后左旋      |

**实例分析**  
- 案例1（LL型）：  
  删除导致节点60失衡，左子树高度差+2 → 执行**单右旋**  
  ```plaintext
    60(balance=+2)        55
     /                   / \
    55(balance=+1)  →   50  60
   /
  50
  ```

---

### 知识点3：不平衡传导处理
**高度传播特性**  
删除操作可能引发连锁失衡，需沿父节点路径逐层检查至根节点  

**处理算法**  
```python
def rebalance(node):
    while node is not None:
        update_balance_factor(node)
        if abs(node.bf) > 1:
            perform_rotation(node)
        node = node.parent  # 向上传导检查
```

**复杂度**  
时间复杂度：O(log n)（树高度限制）

---

## 总结区

### 核心结论
1. **删除一致性**：平衡调整策略与插入操作共享同一旋转逻辑库  
2. **传导特性**：单个删除操作最多需要O(log n)次旋转调整  
3. **考试重点**：  
   - 双旋转场景的步骤分解（LR/RL型）  
   - 前驱/后继选择对后续调整路径的影响  

### 典型题型
- 给定删除序列，绘制各阶段AVL树形态  
- 计算特定旋转操作后的平衡因子分布  
- 分析不同替换策略对调整次数的影响  

### 记忆口诀
"删节查三代，孙位定旋向，传导到根停，插删调同方"

---

本笔记通过结构化呈现删除操作的核心逻辑链，建议结合《算法导论》第12章进行复杂度推导练习，重点掌握示例中4种旋转类型的图形化转换关系。