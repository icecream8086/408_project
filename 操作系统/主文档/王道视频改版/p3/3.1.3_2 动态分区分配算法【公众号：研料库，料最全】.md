# 动态分区分配算法

## 摘要

本节系统解析四种动态分区分配算法（首次适应、最佳适应、最坏适应、邻近适应），通过对比核心策略、数据结构及性能特征，构建内存分配决策框架。重点揭示算法对碎片化与系统开销的差异化影响。

---

## 主题

动态内存管理中空闲分区的选择策略，核心矛盾是**内存利用率**与**分配效率**的权衡。通过四种算法实现路径的对比，掌握内存管理器的设计要点。

> 重点难点
>
> - 算法操作流程的时间/空间复杂度差异
> - 内部碎片与外部碎片的产生机制
> - 算法选择与系统负载特征的匹配关系

---

## 线索区

### 知识点 1：首次适应算法（First Fit）

**定义**  
从内存低地址开始线性扫描，选择首个满足容量的空闲分区

> **数据结构**

- 单向链表维护空闲区
- 节点按**地址递增**排序

**性能特征**  

| 维度 | 特性 |  
|-------------|---------------------------|  
| 时间效率 | $O(n)$ 线性扫描 |  
| 空间利用率 | 低地址区易产生**外部碎片**|  
| 典型场景 | 实时系统/快速分配需求 |

> **现实类比**
> 图书馆从入口处开始寻找空座位，导致前排座位碎片化严重

---

### 知识点 2：最佳适应算法（Best Fit）

**定义**  
选择满足需求的最小空闲分区，最大限度保留大块连续空间

> **数据结构**

- 双向链表维护空闲区
- 节点按**容量递增**排序

**性能特征**  

| 维度 | 特性 |  
|-------------|-------------------------------|  
| 时间效率 | $O(n)$ 需完整遍历 |  
| 空间利用率 | 产生**难以利用的微小碎片** |  
| 典型场景 | 嵌入式系统/内存资源紧缺 |

> **现实类比**
> 拼图时选择最接近当前图块的空位，导致剩余空间支离破碎

---

### 知识点 3：最坏适应算法（Worst Fit）

**定义**  
优先分配最大空闲分区，抑制微小碎片的产生

> **数据结构**

- 堆结构维护空闲区
- 始终访问**最大节点**

**性能特征**  

| 维度 | 特性 |  
|-------------|-------------------------------|  
| 时间效率 | $O(1)$ 堆顶直接访问 |  
| 空间利用率 | 加速**大分区耗尽**风险 |  
| 典型场景 | 批处理系统/进程规模均匀 |

> **技术演进**
> 针对最佳适应算法的缺陷，通过逆向选择策略改善碎片分布

---

### 知识点 4：邻近适应算法（Next Fit）

**定义**  
从上一次分配位置开始循环查找，降低低地址区的扫描压力

> **数据结构**

- 循环链表维护空闲区
- 游标指针记录查找起点

**性能特征**  

| 维度 | 特性 |  
|-------------|-------------------------------|  
| 时间效率 | $O(n)$ 但实际扫描次数更少 |  
| 空间利用率 | 高地址区易形成**分区碎片** |  
| 典型场景 | 交互式系统/中等规模内存 |

> **优化路径**
> 在首次适应算法基础上引入循环查找机制，属于空间换时间策略的变体

---

## 总结区

### 算法对比矩阵

| 算法     | 时间复杂度 | 空间利用率 | 碎片特征       | 适用场景     |
| -------- | ---------- | ---------- | -------------- | ------------ |
| 首次适应 | $O(n)$     | 中等       | 低地址区碎片   | 通用型系统   |
| 最佳适应 | $O(n)$     | 高         | 微观碎片累积   | 内存受限系统 |
| 最坏适应 | $O(1)$     | 低         | 大分区快速耗尽 | 均匀负载系统 |
| 邻近适应 | $O(n)$     | 中等       | 全域分布碎片   | 交互式系统   |

### 考点聚焦

1. 给定内存请求序列，绘制各算法的分配过程图
2. 计算不同算法产生的碎片总量（注意区分内部/外部碎片）
3. 结合系统特性（实时性/内存容量）推荐适用算法

### 实验扩展

使用`malloc`/`free`模拟实现四种算法，通过**碎片率**与**分配延迟**指标验证理论分析
