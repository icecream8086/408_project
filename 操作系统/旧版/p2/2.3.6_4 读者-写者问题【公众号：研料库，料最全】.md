# 读者-写者问题

## 摘要

本节探讨了经典的进程同步与互斥问题——读者-写者问题。通过分析读者和写者进程对共享文件的访问需求，提出了使用PV操作解决互斥和同步问题的方案，并讨论了写者进程可能面临的饿死问题及其解决方案。

## 主题

读者-写者问题涉及两种进程：读者进程和写者进程，它们并发访问共享文件。读者进程允许多个同时读取，而写者进程需要独占访问。通过PV操作和计数器count，实现了复杂的互斥规则，解决了写者饿死问题。

> 重点难点
>
> - 读者进程之间的并发访问与互斥
> - 写者进程的饿死问题及其解决方案
> - 计数器count的作用与互斥实现

## 线索区

### 知识点1：读者-写者问题的具体要求
- 允许多个读者同时读取文件。
- 同一时刻只允许一个写者进程写入文件。
- 写者进程在写操作完成前，不允许其他读者或写者访问文件。
- 写者在写操作前需确保其他进程已全部退出。

### 知识点2：PV操作解决读者-写者问题
- 使用互斥信号量RW实现进程对共享文件的互斥访问。
- 设置变量count记录当前访问文件的读进程数量，解决读者进程之间的互斥问题。
- 引入互斥信号量mute x，确保对count的访问是互斥的。

### 知识点3：写进程的阻塞和饿死问题
- 只要还有读进程在读文件，写进程就会一直阻塞，可能导致写进程饿死。
- 引入另一个互斥信号量W，用于实现写优先，确保写进程在等待时不会被读进程无限阻塞。

### 知识点4：信号量的排队功能与读写公平法
- 信号量具有排队功能，读者先对W执行P操作，排在队列头部，写者进程2排在读者之后。
- 这种算法被称为读写公平法，并非真正的写优先。

### 知识点5：计数器count的作用与互斥实现
- 计数器count用于判断读者进程是否为第一个或最后一个，确保读者之间不互斥，写者与其他进程互斥。
- 通过PV操作实现count变量的互斥访问，确保同一时刻只有一个进程对count进行检查和赋值。

## 总结区

本节详细介绍了读者-写者问题的背景、具体要求和解决方案。通过PV操作和计数器count，实现了复杂的互斥规则，解决了写者饿死问题。读者-写者问题为解决复杂互斥问题提供了思路，生产者消费者模型适用于同步问题，读者-写者问题适用于互斥问题。通过计数器count和PV操作，实现了复杂的互斥规则。