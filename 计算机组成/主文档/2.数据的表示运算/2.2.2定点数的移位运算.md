# 定点数的移位运算

## 摘要

**目的**：解析三类移位运算的底层规则与应用场景  
**方法**：通过编码规则对比（原码/补码）、硬件实现差异分析  
**结果**：建立移位运算与乘除法的数学映射关系  
**结论**：移位运算通过硬件并行性实现高效数值计算

---

## 主题

**核心方法**：符号位处理策略（算术移位）→ 无符号扩展（逻辑移位）→ 循环链路设计（循环移位）  
**关键词**：符号位保持、空位填充规则、多字节运算、IEEE Std 91-1984  
**问题提示**：

1. 负补码右移为何补 1？
2. 循环移位如何实现跨字节数据传递？

> **重点难点**
>
> - 补码负数的符号位扩展逻辑（右移补 1 的数学证明）
> - 带进位循环移位的硬件实现结构
> - 移位运算与乘法器的性能对比（门延迟分析）

---

## 线索区

### 算术移位（Arithmetic Shift）

**定义**  
通过符号位保持实现有符号数缩放操作

> **数学原理**

- 十进制：$N \times 10^k \Leftrightarrow$ 小数点右移$k$位
- 二进制：$N \times 2^k \Leftrightarrow$ **左移$k$位**，$N \div 2^k \Leftrightarrow$ **右移$k$位**

**补码规则**  

| 操作 | 正数 | 负数 |  
|------|------|------|  
| 右移 | 补 0 | 补 1 |  
| 左移 | 补 0 | 补 0 |

> **应用场景**

- 快速乘除：**8 位左移 3 位** ≈ ×8 运算（仅需**3ns 延迟** vs 乘法器 15ns）
- 精度控制：截断低位时自动执行符号扩展

---

### 逻辑移位（Logical Shift）

**定义**  
无符号位处理的位级平移操作

> **硬件实现**

```verilog
assign out = {0, data[7:1]}; // 右移示例（高位补0）
```

> **典型应用**

- RGB 色彩分量提取：`0x00FF0000`右移 16 位 → 红色分量
- 位掩码生成：左移 3 位生成`0x00000008`掩码

**与算术移位对比**  

| 特征 | 算术移位 | 逻辑移位 |  
|-------------|----------------|---------------|  
| 符号位处理 | 保持 | 忽略 |  
| 空位填充 | 符号复制 | 补 0 |  
| 数据类型 | 有符号数 | 无符号数 |

---

### 循环移位（Rotational Shift）

**定义**  
首尾相连的闭环移位系统

> **硬件结构**

```txt
         +---+    +---+    +---+
Carry → | C | → | D | → | Q | → ...
         +---+    +---+    +---+
```

> _注：74LS194 芯片可实现 4 位带进位循环移位_
> **多字节扩展**

- 大数运算：256 位 AES 密钥通过 8 次 32 位循环移位完成扩散
- 校验计算：CRC 校验码生成时执行多项式模除

> **性能参数**

- 单周期移位位数：**4 位/clock**（典型 ALU 设计）
- 级联延迟：每增加 1 字节延迟增加**1.2ns**

---

## 总结区

> **知识图谱**

```txt
算术移位 → 符号扩展 → 快速乘除
逻辑移位 → 无符号处理 → 位操作
循环移位 → 闭环链路 → 大数运算
```

> **考点聚焦**

1. 补码右移的电路实现（与门+或门级联结构）
2. 移位器与乘法器的面积对比（**1:5**门数量比）
3. 循环移位在 DES 加密算法中的具体应用

> **易错警示**

- 负数补码左移时未检测溢出可能导致符号错误
- 混淆逻辑右移与算术右移会造成无符号数符号位污染
