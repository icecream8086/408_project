# 存储系统与CPU访问机制

## 摘要
本课程主要介绍了存储系统的基本概念、CPU如何访问存储系统、指令的构成与寻址方式，以及虚拟地址到物理地址的转换机制。通过详细的讲解和图示，帮助学生理解存储系统的内部工作原理，特别是缓存（Cache）和快表（TLB）的作用及其映射方式。

## 主题
本课程的核心内容围绕存储系统的访问机制展开，重点讲解了CPU如何通过虚拟地址访问数据、虚拟地址到物理地址的转换过程、缓存和快表的作用及其映射方式。课程还涉及了指令的构成、寻址方式以及多级页表的查询过程。

> 重点难点
>
> - 虚拟地址到物理地址的转换机制
> - 缓存（Cache）和快表（TLB）的映射方式
> - 多级页表的查询过程
> - 指令的构成与寻址方式

## 线索区

### 知识点1：CPU访问存储系统的基本流程
- CPU通过控制器取指令并执行，控制器内部有IR（指令寄存器）和PC（程序计数器）。
- 指令由操作码和地址码构成，操作码指明执行效果，地址码指明操作数据的来源（寄存器、主存或立即数）。
- 数据的寻址方式包括隐含寻址、立即寻址、直接寻址、间接寻址、寄存器寻址等。

### 知识点2：虚拟地址到物理地址的转换
- 虚拟地址通过内存管理单元（MMU）转换为物理地址，MMU通过查页表（慢表）或快表（TLB）完成转换。
- 虚拟地址拆分为虚拟页号和页内偏移量，虚拟页号用于查页表或TLB，页内偏移量与物理页框号拼接得到物理地址。
- 物理地址用于访问缓存（Cache），若缓存未命中则访问主存。

### 知识点3：缓存（Cache）和快表（TLB）的映射方式
- 缓存的映射方式包括全相连映射、直接映射和组相连映射。
  - **全相连映射**：主存块可以放到缓存中的任何位置。
  - **直接映射**：主存块只能放到缓存中的固定位置。
  - **组相连映射**：主存块可以放到缓存特定分组中的任何位置。
- 快表（TLB）的映射方式与缓存类似，通常采用全相连或组相连映射。

### 知识点4：多级页表的查询过程
- 系统采用多级页表时，虚拟页号拆分为一级页号和二级页号，分别查询一级和二级页表。
- 一级页表查询找到下一级页表的页框号，二级页表查询找到最终物理页框号。
- 快表（TLB）保存整个虚拟页号，不保存二级页表项。

## 总结区
本课程详细讲解了存储系统的访问机制，特别是CPU如何通过虚拟地址访问数据、虚拟地址到物理地址的转换过程、缓存和快表的作用及其映射方式。理解这些概念对于解决计算机组成原理中的存储系统相关题目至关重要。建议学生在理解课程内容后，先尝试解决第三章的课后大题，再观看总结视频进行巩固。