# DMA控制方式详解

## 摘要

本课程详细介绍了DMA（直接内存访问）控制方式的工作原理、内部结构、工作流程及其与CPU的交互。DMA控制器通过减少CPU的干预，提高数据传输效率，特别适用于高速设备的数据传输。课程还对比了DMA控制方式与中断控制方式的优缺点，并探讨了DMA控制器与CPU在访存冲突中的解决方案。

## 主题

DMA控制方式的核心在于通过DMA控制器直接管理数据传输，减少CPU的干预，从而提高数据传输效率。DMA控制器内部包含多个关键寄存器，如主存地址计数器、传送长度计数器等，用于管理数据传输过程。DMA控制器与CPU的交互主要通过系统总线进行，数据传输完成后通过中断机制通知CPU。

> 重点难点
>
> - DMA控制器的工作原理及其内部结构
> - DMA控制器与CPU的访存冲突及解决方案
> - DMA控制方式与中断控制方式的对比

## 线索区

### 知识点1: DMA控制器的基本工作原理
DMA控制器通过数据总线将数据传送到主存，完成写操作。数据传送完成后，DMA控制器通过中断信号向CPU报告任务完成。

### 知识点2: DMA控制器的内部结构
DMA控制器内部包含重要的寄存器，如控制状态逻辑、DMA请求触发器、主存地址计数器、传送长度计数器等。控制状态逻辑负责时序控制和总线申请等操作。

### 知识点3: DMA控制器的工作流程
主存地址计数器（AR）用于存放主存的读写地址，传送长度计数器（WC）用于记录传送的数据量。每传送完一个数据，主存地址指针和长度计数器会自动变化。

### 知识点4: DMA控制器与CPU的交互
DMA控制器在传送数据时，CPU可以继续执行主程序，相比程序中断方式，DMA控制器可以一次性传送一整块数据，减少CPU的干预。

### 知识点5: DMA控制器与系统总线的交互
DMA控制器在传送数据时需要占用系统总线，CPU决定是否将系统总线的使用权分配给DMA控制器。采用三总线结构时，DMA控制器和CPU可以通过专用总线访问主存。

### 知识点6: DMA控制方式的特点
DMA控制方式的特点包括：I/O设备和主机可以并行工作，CPU不需要暂停当前程序去传送数据。大多数引入DMA控制器的计算机会为DMA接口和主存之间提供专用的数据通路。

### 知识点7: DMA控制方式与中断控制方式的对比
中断控制方式需要CPU通过中断处理程序完成数据传输，每次中断处理都会涉及程序执行流的切换，耗时较长。DMA控制方式由DMA控制器负责数据传输，CPU只需进行预处理和后处理，数据传输效率更高。

## 总结区

DMA控制方式通过减少CPU的干预，提高数据传输效率，特别适用于高速设备的数据传输。DMA控制器内部包含多个关键寄存器，用于管理数据传输过程。DMA控制器与CPU的交互主要通过系统总线进行，数据传输完成后通过中断机制通知CPU。DMA控制方式与中断控制方式相比，具有更高的数据传输效率，但需要解决与CPU的访存冲突问题。