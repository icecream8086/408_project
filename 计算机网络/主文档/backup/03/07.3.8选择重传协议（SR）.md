# 选择重传协议（SR）详解

## 摘要

本节课详细讲解了选择重传协议（SR）的工作原理，包括发送方和接收方的响应机制、滑动窗口机制、超时重传机制以及窗口大小的设计原则。SR协议通过逐帧确认和缓存机制，避免了批量重传的问题，提高了传输效率。

## 主题

选择重传协议（SR）是一种改进的滑动窗口协议，通过逐帧确认和缓存机制，避免批量重传，提高传输效率。核心方法包括发送方的响应机制、接收方的缓存机制、超时重传机制以及窗口大小的设计原则。

> 重点难点
>
> - 发送方和接收方的滑动窗口机制
> - 超时重传机制的设计与实现
> - 窗口大小的设计原则及其对协议性能的影响

## 线索区

### 知识点1：发送方的响应机制
- 发送方需要响应三件事：处理上层调用、检查序号和发送数据帧。
- 如果序号在发送窗口内，发送数据帧；否则缓存或返回给上层。
- 收到ACK确认帧后，标记为已接收，并根据确认帧的序号移动窗口。

### 知识点2：接收方的处理机制
- 接收方对接收窗口内的帧采取“来者不拒”的策略。
- 接收方确认正确接收的帧，缓存失序帧并返回确认帧。
- 接收窗口的前移条件：只有当所有期望的帧都收到并确认后，窗口才能前移。

### 知识点3：超时事件和重传机制
- 每个帧都有自己的定时器，超时事件发生后重传该帧。
- 结合SR协议运行的例子讲解超时重传机制。

### 知识点4：窗口大小与序号冲突问题
- 窗口大小不能过大，应与序号范围匹配。
- 发送窗口大小应等于接收窗口大小，以避免序号冲突。
- 窗口大小的上限为2的N减1次方，N为比特数。

## 总结区

本节课详细讲解了选择重传协议（SR）的工作原理，包括发送方和接收方的响应机制、滑动窗口机制、超时重传机制以及窗口大小的设计原则。SR协议通过逐帧确认和缓存机制，避免了批量重传的问题，提高了传输效率。重点难点包括发送方和接收方的滑动窗口机制、超时重传机制的设计与实现以及窗口大小的设计原则及其对协议性能的影响。